// すでに出しているフォームは非表示にする
$('.add_plan_detail').hide();

// 編集画面を表示
if (lastFormId === '#edit_plan_detail_<%= @plan_detail.id %>') {
  // 表示したフォームを削除
  $('#edit_plan_detail_<%= @plan_detail.id %>').slideToggle('fast').empty();

  //表示したフォームの記憶を削除
  var lastFormId = ''
} else {
  // すでに表示している編集フォームは閉じて削除
  if (lastFormId) {$(lastFormId).slideToggle('fast').empty();}

  // 編集フォームを描写
  $('#edit_plan_detail_<%= @plan_detail.id %>').html("<%= j(render 'plan_details/plan_detail_form', plan_detail: @plan_detail, plan_detail_title: 'アクティビティの編集') %>")

  //持ち物を描写
  var belongings = $('#input_belongings').val().split(/\r\n|\r|\n/);
  var output = new Array();
  $.each(belongings, function(index, value) {
      output += '<li>'+value+'</li>';
  });
  $('#output_belongings').html(output);

  // 編集画面を出力
  $('#edit_plan_detail_<%= @plan_detail.id %>').slideToggle('fast');

  // 表示したフォームのIDを記憶
  var lastFormId = '#edit_plan_detail_<%= @plan_detail.id %>'
}

// datepickerカレンダー表示用
var data = {'data-date-format': 'YYYY-MM-DD hh:mm:ss' };
$(function(){
  $('.datepicker').attr(data);
  $('.datepicker').datetimepicker();
});

// 持ち物描写用
$('#input_belongings').on('input', function() {
  var belongings = $(this).val().split(/\r\n|\r|\n/);
  var output = new Array();
  $.each(belongings, function(index, value) {
      output += '<li>'+value+'</li>';
  });
  $('#output_belongings').html(output);
});
