<% provide(:title, "プランの編集") %>
<%= render 'plans/plan_form', plan_form_button: 'プラン概要を変更する' %>
<%# アクティビティがあれば表示 %>
<% if @plan_details %>
  <%= render 'plans/belongings' %>
  <%= render 'plan_details/plan_details' %>
<% end %>
<script type="text/javascript">
// 共有するJavaScriptは/app/assets/javascripts/application.jsに記載
  $(function() {
    //１アクティビティにマウスを載せたら編集メニューを表示
    $('.plan-detail').mouseover(function(){
      $(this).css('background-color', '#E0FFFF');
      $(this).children('.plan-detail-edit').show();
    })

    $('.plan-detail').mouseout(function(){
      $(this).css('background-color', '');
      $(this).children('.plan-detail-edit').hide();
    })

    // 新規アクティビティ追加フォーム表示
    $('#add-plan-detail-button').children('img').on('click', function(){
      $(lastFormId).hide('fast').empty(); //同じフォームのボタンならフォームを隠すだけ
      if (lastFormId ==='#add-plan-detail') {
        lastFormId = '';   // 表示するフォームのクラスを削除
      } else {
        lastFormId = '#add-plan-detail';   // 表示するフォームのクラスを記憶
        $(lastFormId).html("<%= j(render 'plan_details/plan_detail_form', plan_detail: @new_plan_detail, plan_detail_title: 'アクティビティの追加') %>");
        $(lastFormId).show('fast'); // 編集画面を描く
        jQuery.setDatepicker(); //Datepicker設定

      }
    })
  })
</script>
